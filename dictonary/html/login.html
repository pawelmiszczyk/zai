<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Główna strona</title>
    <link rel="stylesheet" type="text/css" href="../css/style.css">
</head>
<body>
    <header>
        <h1><a href="../html/index.html">Firma XYZ - Intranet</a></h1>
    </header>
	
	<div id="myModal" class="modal">
      <div class="modal-content">
        <span class="close" id="closeModal">&times;</span>
        <p id="modalMessage"></p>
      </div>
    </div>

	<form action="../php/login.php" method="post">
		<h2>Logowanie</h2>
		<label for="username">Nazwa użytkownika:</label>
		<input type="text" id="username" name="username" required>
		<label for="password">Hasło:</label>
		<input type="password" id="password" name="password" required>
		<button type="submit">Zaloguj się</button>
		<input type="hidden" name="csrf_token" id="csrf_token">
	</form>
	
	<script>
        // Obsługa komunikatu z adresu URL
        var params = new URLSearchParams(window.location.search);
        var message = params.get('message');

        if (message) {
            // Pobierz modal i przycisk zamykający
            var modal = document.getElementById("myModal");
            var closeModal = document.getElementById("closeModal");
            var modalMessage = document.getElementById("modalMessage");

            // Ustaw treść komunikatu w modalu
            modalMessage.textContent = message;

            // Po załadowaniu strony, pokaż modal
            window.addEventListener('load', function () {
                modal.style.display = "block";
            });

            // Kliknij przycisk zamykający, aby schować modal
            closeModal.addEventListener('click', function() {
                modal.style.display = "none";
            });
        }
    </script>
	
	<script>
	// Funkcja do pobierania treści z getSession.php za pomocą AJAX
	function getSession() {
		var xhr = new XMLHttpRequest();
		xhr.open("GET", "../php/getSession.php", true);
		xhr.onreadystatechange = function () {
			if (xhr.readyState === 4 && xhr.status === 200) {
				var response = JSON.parse(xhr.responseText);
				document.getElementById("csrf_token").value = response;
			}
		};
		xhr.send();
	}

	// Wywołaj funkcję, aby pobrać zawartość
	getSession();
	</script>
    <footer>
        <p>&copy; 2023 Firma XYZ. Wszelkie prawa zastrzeżone.</p>
    </footer>
</body>
</html>
